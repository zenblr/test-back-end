<kt-portlet>
    <kt-portlet-body class="min-vh-60">

        <div class="table-div kt-padding-t-10">
            <table class="table outer-border">
                <thead>
                    <th class="transparent">Loan Id</th>
                    <th class="transparent">Loan Amount</th>
                    <th class="transparent">Loan Date</th>
                    <th class="transparent">Scheme Name</th>
                    <th class="transparent">Tenure</th>
                    <th class="transparent">Interest Rate</th>
                    <th class="transparent">Last Payment Date</th>
                    <th class="transparent">Status</th>


                </thead>
                <tbody>
                    <tr>
                        <td class="text-gray">{{loanDetails?.customerLoan[0]?.loanUniqueId}}
                            <br>
                            <span *ngIf="loanDetails?.customerLoan[1]">
                                {{loanDetails?.customerLoan[1]?.loanUniqueId}}
                            </span>
                        </td>
                        <td class="text-gray">
                            {{loanDetails?.customerLoan[0]?.loanAmount}}
                            <br>
                            <span *ngIf="loanDetails?.customerLoan[1]">
                                {{loanDetails?.customerLoan[1]?.loanAmount}}
                            </span>
                        </td>
                        <td class="text-gray">{{loanDetails?.loanStartDate | date :'mediumDate'}}</td>
                        <td class="text-gray">
                            {{loanDetails?.customerLoan[0]?.scheme?.schemeName | titlecase}}
                            <br>
                            <span *ngIf="loanDetails?.customerLoan[1]">
                                {{loanDetails?.customerLoan[1]?.scheme?.schemeName | titlecase}}
                            </span>
                        </td>
                        <td class="text-gray">{{loanDetails?.tenure}} Months</td>
                        <td class="text-gray">{{loanDetails?.customerLoan[0]?.interestRate }}%
                            <br>
                            <span *ngIf="loanDetails?.customerLoan[1]">
                                {{loanDetails?.customerLoan[1]?.interestRate }}%
                            </span></td>
                        <td class="text-gray">20,May 2020</td>
                        <td class="text-warning">Pending</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="row justify-content-center kt-padding-t-25 kt-padding-b-15">
            <div class="col-6 text-center">
                <kt-button [value]="'Pay EMI'" [type]="'button'" (click)="getPayableAmount()"></kt-button>
                <span class="kt-padding-5 "></span>
                <kt-button [value]="'View Interest EMI Logs'" [type]="'button'" (click)="viewEmiLogs()"></kt-button>
                <span class="kt-padding-5 "></span>
                <kt-button [value]="'View Part Payment EMI'" [type]="'button'"></kt-button>

            </div>
        </div>
        <div *ngIf="payableAmount">
            <div class="table-div kt-padding-t-10">
                <table class="table outer-border">
                    <thead>
                        <th class="transparent">Principal Outstanding</th>
                        <th class="transparent">Interest Amount</th>
                        <th class="transparent">Penal Interest</th>
                        <th class="transparent">Payable Amount</th>
                        <th class="transparent">Payment Amount</th>
                    </thead>
                    <tbody>
                        <tr>
                            <td>{{payableAmount?.outstandingAmount}}</td>
                            <td>{{payableAmount?.securedInterest}} <br>
                                {{payableAmount?.unsecuredInterest}}</td>
                            <td>{{payableAmount?.securedPenalInterest}}<br>
                                {{payableAmount?.unsecuredPenalInterest}}
                            </td>
                            <td>{{payableAmount?.payableAmount}}</td>
                            <td><input type="text" class="form-control" [formControl]="payableAmt"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="row justify-content-center kt-padding-t-25 kt-padding-b-10">
                <div class="col-6 text-center">
                    <kt-button [value]="'Proceed'" [type]="'button'" (click)="payment()"></kt-button>
                    <span class="kt-padding-5"></span>
                    <kt-button [value]="'Cancel'" [type]="'reset'"
                        (click)="payableAmount = '';paymentDetails = '';payableAmt.enable()">
                    </kt-button>

                </div>
            </div>
        </div>


        <h5 class="kt-padding-t-20 kt-padding-b-20" *ngIf="paymentDetails">Payment Confirmation</h5>
        <div class="table-div" *ngIf="paymentDetails">
            <table class="table outer-border">
                <thead>
                    <th class="transparent">Loan ID</th>
                    <th class="transparent">Loan Payment Date</th>
                    <th class="transparent">Loan Amount</th>
                    <th class="transparent">Payment Amount</th>
                    <th class="transparent">Total Payment Amount</th>
                    <th class="transparent">Select Payment option</th>
                </thead>
                <tbody>
                    <tr>
                        <td class="text-gray">
                            {{paymentDetails?.customerLoan[0]?.loanUniqueId}} <br>
                            {{paymentDetails?.customerLoan[1]?.loanUniqueId}}
                        </td>
                        <td class="text-gray">{{currentDate | date:'mediumDate'}}</td>
                        <td class="text-gray">
                            {{paymentDetails?.customerLoan[0]?.outstandingAmount}} <br>
                            {{paymentDetails?.customerLoan[1]?.outstandingAmount}}
                        </td>
                        <td class="text-gray">{{payableAmt.value}}</td>
                        <td class="text-gray">{{payableAmount?.payableAmount}}</td>
                        <td class="text-gray">
                            <button *ngIf="!paymentValue" (click)="choosePaymentMethod()" class="apply-kyc">Select
                                Payment</button>
                            <button *ngIf="paymentValue" (click)="choosePaymentMethod()" class="apply-kyc">
                                {{ paymentValue.paymentType === 'IMPS' ? 'RTGS | NEFT | IMPS' : paymentValue.paymentType | uppercase }}
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="row justify-content-center kt-padding-t-15 kt-padding-b-15" *ngIf="paymentDetails">
            <div class="col-6 text-center">
                <kt-button [value]="'Confirm'" [type]="'button'"></kt-button>
                <span class="kt-padding-5 "></span>
                <kt-button [value]="'Cancel'" [type]="'reset'" (click)="paymentDetails = '';payableAmt.enable()">
                </kt-button>
                <div class="kt-padding-t-5"> <i>On clicking confirm you will be redirected to available payment
                        options.</i> </div>
            </div>
        </div>

    </kt-portlet-body>
</kt-portlet>